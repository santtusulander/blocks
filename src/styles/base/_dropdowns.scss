// Dropdowns
// =========
$button-dropdown-menu-min-width: 252px;

$dd-font-size: 14px;
$dd-line-height: 1.45;
$dd-menu-max-height: rem(480px);
$dd-menu-min-width: rem(300px);
$dd-menu-rdp-width: rem(300px);
$dd-vertical-padding: em(14px, $dd-font-size);
$dd-horizontal-padding: em(18px, $dd-font-size);

$dt-dd-menu-color: $dt-text-color;
$dt-dd-menu-bg-color: $black;
$dt-dd-menu-bg-image: radial-gradient(circle, rgba($purple, 0), rgba($purple, 0.08)), linear-gradient(rgba($pale-blue, 0.2), rgba($pale-blue, 0.1));

$search-font-size: 12px;
$search-line-height: 1;
$search-vertical-padding: em(9px, $dd-font-size);
$search-input-vertical-padding: em(8px, $search-font-size);
$search-input-left-padding: em(36px, $search-font-size);

%dropdown-item-properties {
  cursor: pointer;

  .dark-theme & {
    color: $dt-text-color;
    box-shadow: inset 0 1px 0 0 rgba($pale-blue, 0.1);

    &:hover,
    &:focus {
      color: $white;
    }

    &:focus {
      box-shadow: inset 0 0 0 2px $pale-blue, 0 0 0 1px rgba($black, 0.1);
    }
  }

  .light-theme & {
    color: $lt-text-color;
    box-shadow: inset 0 1px 0 0 rgba($black, 0.1);

    &:hover,
    &:focus {
      color: $black;
    }

    &:focus {
      box-shadow: inset 0 0 0 2px $pale-blue, 0 0 0 1px rgba($black, 0.1);
    }
  }

  &:hover,
  &:focus,
  &:active,
  &.active,
  &:active:hover,
  &.active:focus {
    font-weight: 500;
    color: $pale-blue;
    text-decoration: none;
    background-color: transparent;
    outline: none;
  }
}

// scss-lint:disable SelectorDepth NestingDepth
// Need to override bootstrap styles
.dropdown-menu,
.navbar-nav .open .dropdown-menu {
  position: absolute;
  width: 100%;
  max-height: $dd-menu-max-height;
  min-width: $dd-menu-min-width;
  padding: 0;
  margin: 0;
  overflow-y: auto !important;
  font-size: rem($dd-font-size);
  line-height: $dd-line-height;
  text-transform: none;
  border: 0;
  border-radius: 2px;
  box-shadow: none;

  .scrollable-menu {
    width: 100%;
    max-height: $dd-menu-max-height;
    padding-left: 0;
    overflow-y: auto;
    list-style-type: none;
  }

  .navbar-right &:not(.dropdown-menu-right) {
    right: auto;
    left: 0;
  }

  &.date-picker-dropdown-menu {
    width: $dd-menu-rdp-width;

    &.multi-month-view {
      width: $dd-menu-rdp-width * 2;
    }

    .dark-theme & {
      background-color: $black;
      background-image: linear-gradient(rgba($purple, 0.05), rgba($purple, 0.05)), linear-gradient(rgba($pale-blue, 0.2), rgba($pale-blue, 0.2));
      background-size: 100%;
    }
  }

  &.button-dropdown-menu {
    min-width: $button-dropdown-menu-min-width;
  }

  .open & {
    animation: showDropdown 250ms ease-out;
  }

  .dropup.open & {
    animation: showDropup 250ms ease-out;
  }

  .dark-theme &,
  .light-theme & {
    .active > a {

      &,
      &:hover,
      &:focus {
        color: $pale-blue;
        background-color: transparent;
      }
    }
  }

  .dark-theme & {
    color: $dt-dd-menu-color;
    background-color: $dt-dd-menu-bg-color;
    background-image: $dt-dd-menu-bg-image;
    background-size: 100%;
  }

  .light-theme & {
    color: $lt-text-color;
    background-color: $white;
    box-shadow: 0 5px 10px rgba($black, 0.2);
  }

  .header-toggle + & {
    top: 110%;
  }

  .form-group {
    width: 100%;
  }

  &.dropdown-account-menu,
  &.dropdown-wide-menu {
    width: 200%;
  }

  > li {
    > a,
    > ul > li > a {
      @extend %dropdown-item-properties;

      padding: $dd-vertical-padding $dd-horizontal-padding;
      font-size: $dd-font-size;
      line-height: $dd-line-height;
    }

    &.action-container  {
      padding: $search-vertical-padding $dd-horizontal-padding;

      .dark-theme & {
        box-shadow: inset 0 -1px 0 0 rgba($pale-blue, 0.1);
      }

      .light-theme & {
        box-shadow: inset 0 -1px 0 0 rgba($black, 0.1);
      }

      .header-search-input {
        float: none;
        width: 100%;
        padding: $search-input-vertical-padding $search-input-vertical-padding $search-input-vertical-padding $search-input-left-padding;
        font-size: rem($search-font-size);
        line-height: $search-line-height;
        border-radius: 20px;

        .dark-theme & {
          background: url('../assets/icons/dt-icon-search.svg') 14px center no-repeat;
          background-size: 14px;
          box-shadow: 0 0 0 1px rgba($white, 0.2);
        }

        .light-theme & {
          background: url('../assets/icons/lt-icon-search.svg') 14px center no-repeat;
          background-size: 14px;
          box-shadow: 0 0 0 1px $silver-80;
        }

        &:hover {
          font-weight: 300;
        }

        &:focus {
          font-weight: 300;
          box-shadow: 0 0 0 2px $pale-blue;
        }
      }
    }

    &.active::after {

      .dark-theme &,
      .light-theme .header &,
      .light-theme .sidebar-layout &,
      .light-theme .configuration-sidebar & {
        background-color: rgba($pale-blue, 0.1);
      }

      .light-theme & {
        background-color: rgba($white, 0.2);
      }
    }

    &.disabled > a {
      &,
      &:hover,
      &:focus {
        color: $grey-60;
      }
    }
  }

  .dropdown-select__option-second-label {
    margin-right: 18px;
  }
}

.navbar-fixed-top .dropdown-menu:not(.dropdown-user-menu) {
  max-height: calc(100vh - #{$header-total-height});
  overflow: auto;

  @include md {
    max-height: calc(100vh - #{$md-header-total-height});
  }
}

.dropup,
.navbar-fixed-bottom .dropdown {

  .dropdown-menu {
    margin-bottom: 0;
  }
}

.dropdown-checklist.dropdown-select .dropdown-menu {
  overflow-y: visible;
  text-transform: none;

  > li {
    display: block;
    height: auto;
  }
}

.dropdown-filter {
  .dropdown-menu {
    .children {
      outline: 0;

      .clear-selection {
        padding: $dd-vertical-padding $dd-horizontal-padding;
        background-color: transparent !important;
      }

      &:focus {
        box-shadow: inset 0 0 0 2px $pale-blue, 0 0 0 1px rgba($black, 0.1);
      }

      .form-group {
        .dark-theme & {
          box-shadow: inset 0 1px 0 0 rgba($pale-blue, 0.1);
        }

        .light-theme & {
          box-shadow: inset 0 1px 0 0 rgba($black, 0.1);
        }

        label {
          display: block;
          padding: $dd-vertical-padding $dd-horizontal-padding;
        }

        .checkbox input + span::before {
          border: 1px solid rgba($white, 0.3);
        }
      }
    }

    .scrollable-menu {
      max-height: 300px;
    }
  }
}

@keyframes showDropdown {
  0% {
    margin-top: -10px;
    opacity: 0;
  }

  100% {
    margin-top: 0;
    opacity: 1;
  }
}

@keyframes showDropup {
  0% {
    margin-bottom: -10px;
    opacity: 0;
  }

  100% {
    margin-bottom: 0;
    opacity: 1;
  }
}
