/*
* Revision: 3.7.0.135397
* Revision date: 11/08/2016
*
* http://www.asperasoft.com/
*
* Â© Copyright IBM Corp. 2008, 2016
*/
"use strict";if(typeof AW4=="undefined")var AW4={};AW4.Utils=function(){function j(a){if(typeof a!="string")return null;var b=a,c=document.createElement("a");c.href=b;var d=c.href;d.indexOf("/",d.length-1)!==-1&&(d=d.slice(0,-1));return d}var a="fasp://initialize",b=typeof navigator!="undefined"?navigator.userAgent:"",c={MAC_LEGACY:b.indexOf("Intel Mac OS X 10_6")!=-1,LINUX:b.indexOf("X11")!=-1|b.indexOf("Linux")!=-1},d={OPERA:/opera|opr/i.test(b)&&!/edge/i.test(b),IE:/msie|trident/i.test(b)&&!/edge/i.test(b),CHROME:/chrome|crios|crmo/i.test(b)&&!/opera|opr/i.test(b)&&!/edge/i.test(b),FIREFOX:/firefox|iceweasel/i.test(b)&&!/edge/i.test(b),FIREFOX_32:/firefox|iceweasel/i.test(b)&&!/Win64/i.test(b)&&!/edge/i.test(b),FIREFOX_64:/firefox|iceweasel/i.test(b)&&/Win64/i.test(b)&&!/edge/i.test(b),EDGE:/edge/i.test(b),SAFARI:/safari/i.test(b)&&!/chrome|crios|crmo/i.test(b)&&!/edge/i.test(b)};(function(){if(document.all&&!window.setTimeout.isPolyfill){var a=window.setTimeout;window.setTimeout=function(b,c){var d=Array.prototype.slice.call(arguments,2);return a(b instanceof Function?function(){b.apply(null,d)}:b,c)},window.setTimeout.isPolyfill=!0}if(document.all&&!window.setInterval.isPolyfill){var b=window.setInterval;window.setInterval=function(a,c){var d=Array.prototype.slice.call(arguments,2);return b(a instanceof Function?function(){a.apply(null,d)}:a,c)},window.setInterval.isPolyfill=!0}})();var e=function(a,b){var c="";a==-1&&(c="Invalid request");return{error:{code:a,internal_message:c,user_message:b}}},f=function(a){var b;if(typeof a=="string"&&(a.length===0||a.replace(/\s/g,"")==="{}"))return{};try{b=JSON.parse(a)}catch(c){b=e(-1,c)}return b},g=function(a,b){var c=function(a){var b=a.split("."),c=[];for(var d=0;d<b.length;d++){var e=parseInt(b[d],10);isNaN(e)||c.push(e)}return c},d=c(a),e=c(b),f;for(f=0;f<Math.min(d.length,e.length);f++){if(d[f]<e[f])return!0;if(d[f]>e[f])return!1}return!1},h=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=((a+16)*Math.random()).toFixed()%16;b!=="x"&&(c=c&3|8);return c.toString(16)})},i=function(b){var e=!1,f=function(a){typeof b=="function"&&b(a)};if(d.CHROME||d.OPERA)document.body.focus(),document.body.onblur=function(){e=!0},document.location=a,setTimeout(function(){document.body.onblur=null,f(e)},500);else if(d.EDGE)document.location=a;else if(d.FIREFOX_64||d.FIREFOX_32&&!c.LINUX){var g=document.createElement("IFRAME");g.src=a,g.style.visibility="hidden",g.style.position="absolute",document.body.appendChild(g)}return null};return{FASP_URL:a,OS:c,BROWSER:d,versionLessThan:g,createError:e,generateUuid:h,launchConnect:i,parseJson:f,getFullURI:j}}(),AW4.XMLhttpRequestImplementation=function(){var a=function(a){typeof a.callback=="function"&&a.callback()},b=function(){if(c()===null)return!1;return!0},c=function(){typeof XMLHttpRequest=="undefined"&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}return null});return new XMLHttpRequest},d=function(a,b,d,e,f){var g=c();g.onreadystatechange=function(a){if(g.readyState==4){if(typeof e!="function")return;e(g.status,g.responseText,f)}},g.open(a,b,!0),a.toUpperCase()==="GET"?g.send():g.send(d);return null};return{isSupportedByBrowser:b,init:a,httpRequest:d}},AW4.NPAPIrequestImplementation=function(){function h(b,c,d,e,f){if(a!=null){var g=function(a){var b=AW4.Utils.parseJson(a);typeof b.error!="undefined"?e(b.error.code,a,f):e(200,a,f)};d==null&&(d=""),a.httpRequestImplementation(b,c,d,g);return null}}function g(g){var h=g.callback||function(){};try{if(!!e()&&a==null)if(AW4.Utils.BROWSER.IE&&new ActiveXObject("Aspera.AsperaWebCtrl.1")||navigator.mimeTypes[d()]!==undefined){c=g.containerId,b=g.pluginId,f(g.initializeTimeout);var i=setInterval(function(){if(!a||!a.queryBuildVersion)return null;clearInterval(i),AW4.Utils.versionLessThan(a.queryBuildVersion(),"3.6")?(a=null,h(AW4.Connect.STATUS.FAILED)):h(AW4.Connect.STATUS.RUNNING)},500)}else a==null&&h(AW4.Connect.STATUS.FAILED)}catch(j){h(AW4.Connect.STATUS.FAILED)}return null}function f(e){var f=document.getElementById(c);if(f==null)f=document.createElement("div"),f.setAttribute("id",c),f.setAttribute("style","display:inline-block;height:1px;width:1px;");else while(f.firstChild)f.removeChild(f.firstChild);a=document.createElement("object"),a.setAttribute("name",b),a.setAttribute("id",b),a.setAttribute("type",d()),a.setAttribute("width",1),a.setAttribute("height",1);var g=document.createElement("param");g.setAttribute("name","connect-launch-wait-timeout-ms"),g.setAttribute("value",e),a.appendChild(g),f.appendChild(a),document.body.appendChild(f)}function e(){if(AW4.Utils.BROWSER.IE||AW4.Utils.BROWSER.SAFARI||AW4.Utils.BROWSER.FIREFOX_32&&AW4.Utils.OS.LINUX)return!0;return!1}function d(){return"application/x-aspera-web"}var a=null,b=null,c=null;return{isSupportedByBrowser:e,init:g,httpRequest:h}},AW4.PPAPIrequestImplementation=function(){function p(c,e,f,g,h){if(d!=null){var i=b++,j={id:h,callback:g};a[i]=j,d.postMessage({id:i,method:c,url:e,data:f})}}function o(a){if(!!g()&&d==null){e=a.callback||function(){},c=a.pluginId;var b=h(a.containerId);i(b);var f=j(a.sdkLocation);b.appendChild(f),document.body.appendChild(b)}}function n(b){if(typeof b.data=="object"){var c=b.data.id;if(typeof a[c]=="undefined")return;var d=a[c].callback,e=a[c].id;if(!d)return;var f=b.data.status,g=b.data.response;d(f,g,e),delete a[c]}}function m(){d=document.getElementById(c),e()}function l(a){}function k(a){}function j(a){var b=document.createElement("embed");b.setAttribute("name",c),b.setAttribute("id",c),b.setAttribute("path","plugin/chrome"),b.setAttribute("src",a.replace(/\/$/,"")+"/plugin/chrome/url_loader.nmf"),b.setAttribute("type",f()),b.setAttribute("style","display:inline-block;height:1px;width:1px;");return b}function i(a){a.addEventListener("load",m,!0),a.addEventListener("message",n,!0),a.addEventListener("error",k,!0),a.addEventListener("crash",l,!0)}function h(a){var b=document.getElementById(a);if(b==null)b=document.createElement("div"),b.setAttribute("id",a),b.setAttribute("style","display:inline-block;height:1px;width:1px;");else while(b.firstChild)b.removeChild(b.firstChild);return b}function g(){return navigator.mimeTypes[f()]!==undefined}function f(){return"application/x-pnacl"}var a={},b=0,c=null,d=null,e=null;return{isSupportedByBrowser:g,init:o,httpRequest:p}},AW4.RequestHandler=function(){var a={GET:"GET",POST:"POST"},b={INITIALIZING:0,RETRYING:1,RUNNING:2,FAILED:3,STOPPED:4},c=43003,d="https://local.connectme.us:",e="/v5/connect",f=10,g=null,h=null,i=c,j=0,k={},l=[],m=null,n=[0,1],o=function(){while(l.length>0){var a=l.pop(),b=d+a.port+e+a.path;g.httpRequest(a.method,b,a.data,s,a.id)}return null},p=function(a){h=a,h==b.RUNNING&&o(),m!==null&&m(h);return null},q=function(l,m,n){var o=k[n].port;delete k[n];if(h==b.RUNNING||h==b.STOPPED)return null;if(l==200)i=o,p(b.RUNNING);else if(o===c)for(var r=c+1;r<c+f;r++){var s=j++,t=a.GET,u="/info/ping",v=d+r+e+u,w={id:s,method:t,port:r,path:u,data:null,callbacks:null};k[s]=w,g.httpRequest(t,v,null,q,s)}return null},r=function(f){if(h==b.RUNNING||h==b.STOPPED)return null;h==b.INITIALIZING&&!f&&(AW4.Utils.launchConnect(),p(b.RETRYING));var i=n[0]+n[1];setTimeout(r,i*1e3),n[0]=n[1],n[1]=i;var l=j++,m=a.GET,o="/info/ping",s=d+c+e+o,t={id:l,method:m,port:c,path:o,data:null,callbacks:null};k[l]=t,g.httpRequest(m,s,null,q,l);return null},s=function(a,c,d){if(h==b.STOPPED)return null;var e=k[d];if(!!e){if(a==0){if(h==b.INITIALIZING||h==b.RUNNING)p(b.RETRYING),AW4.Utils.launchConnect(),r();l.push(e);return null}h!=b.RUNNING&&p(b.RUNNING);var f=AW4.Utils.parseJson(c);if(a==200&&typeof f.error=="undefined"){var g=e.callbacks.success;g(f)}else{var g=e.callbacks.error;g(f)}delete k[d];return null}},t=function(a){m=a},u=function(a,c,f,m){if(h==b.STOPPED)return null;if(m==""||m==null||typeof m=="undefined")m={};typeof m.success!="function"&&(m.success=function(){}),typeof m.error!="function"&&(m.error=function(){});var n=j++,o={id:n,method:a,port:i,path:c,data:f,callbacks:m};k[n]=o;if(h!=b.RUNNING){l.push(o);return null}var p=d+i+e+c;g.httpRequest(a,p,f,s,n);return null},v=function(a){p(b.INITIALIZING),g=function(){var a=new AW4.NPAPIrequestImplementation;if(a.isSupportedByBrowser())return a;if(AW4.Utils.OS.MAC_LEGACY&&AW4.Utils.BROWSER.CHROME){c=33003,d="http://127.0.0.1:",a=new AW4.PPAPIrequestImplementation;if(a.isSupportedByBrowser())return a}a=new AW4.XMLhttpRequestImplementation;if(a.isSupportedByBrowser())return a;return"This browser is not supported"}();if(typeof g=="string")return AW4.Utils.createError(-1,g);var e=function(){var c=function(){h!=b.RUNNING&&p(b.FAILED)};setTimeout(c,a.initializeTimeout),r(!0)},f={pluginId:a.pluginId,containerId:a.containerId,initializeTimeout:a.initializeTimeout,sdkLocation:a.sdkLocation,callback:e};g.init(f);return null},w=function(){h=b.STOPPED;return!0};return{HTTP_METHOD:a,STATUS:b,init:v,start:u,addStatusListener:t,stopRequests:w}},AW4.Connect=function(a){function z(a){a==n.STATUS.RUNNING&&j&&t(AW4.Connect.HTTP_METHOD.GET,"/file/initialize-drag-drop",null,null);if(q==AW4.Connect.STATUS.OUTDATED)return null;if(a==n.STATUS.INITIALIZING)q=AW4.Connect.STATUS.INITIALIZING;else if(a==n.STATUS.RETRYING)q=AW4.Connect.STATUS.RETRYING;else if(a==n.STATUS.FAILED)q=AW4.Connect.STATUS.FAILED;else{if(i!=""&&p==""){var b=function(a){p=a.version,q=AW4.Connect.STATUS.RUNNING,y(q)},c=function(a){q=AW4.Connect.STATUS.OUTDATED,y(q)},d={success:b,error:c};t(AW4.Connect.HTTP_METHOD.POST,"/update/require",{min_version:i,sdk_location:e},d);return null}q=AW4.Connect.STATUS.RUNNING}y(q)}function y(a){for(var b=0;b<o.length;b++)var c=o[b](AW4.Connect.EVENT.STATUS,a)}function x(a,b){var c=!1,d=b.indexOf(a);while(d>-1)b.splice(d,1),c=!0,d=b.indexOf(a);return c}function w(){u(m,{success:v})}function v(a){m=a.iteration_token;for(var b=0;b<k.length;b++)k[b](AW4.Connect.EVENT.TRANSFER,a)}function u(a,b){if(r(a))return null;var c={iteration_token:a};return t(AW4.Connect.HTTP_METHOD.POST,"/transfers/activity",c,b)}function t(a,b,c,d){if(n==null)return null;var e={};if(!r(c))for(var f in c)c.hasOwnProperty(f)&&(e[f]=c[f]);var g=JSON.stringify(s(e));n.start(a,b,g,d);return null}function s(a){g.length!==0&&(a.authorization_key=g),r(a.aspera_connect_settings)&&(a.aspera_connect_settings={}),a.aspera_connect_settings.app_id=f;return a}function r(a){return a===""||a===null||typeof a=="undefined"}r(a)&&(a={}),AW4.Connect.HTTP_METHOD={GET:"GET",POST:"POST"},AW4.Connect.STATUS={INITIALIZING:"INITIALIZING",RETRYING:"RETRYING",RUNNING:"RUNNING",OUTDATED:"OUTDATED",FAILED:"FAILED"},AW4.Connect.EVENT={ALL:"all",TRANSFER:"transfer",STATUS:"status"},AW4.Connect.TRANSFER_STATUS={CANCELLED:"cancelled",COMPLETED:"completed",FAILED:"failed",INITIATING:"initiating",QUEUED:"queued",REMOVED:"removed",RUNNING:"running",WILLRETRY:"willretry"};var b=a.connectLaunchWaitTimeoutMs||5e3,c=a.id||"aspera-web",d=a.containerId||"aspera-web-container",e=AW4.Utils.getFullURI(a.sdkLocation)||"//d3gcli72yxqn2z.cloudfront.net/connect/v4",f="",g=a.authorizationKey||"",h=a.pollingTime||2e3,i=a.minVersion||"",j=a.dragDropEnabled||!1,k=[],l=0,m=0,n=null,o=[],p="",q=AW4.Connect.STATUS.INITIALIZING;this.addEventListener=function(a,b){if(typeof a!=typeof AW4.Connect.EVENT.ALL)return AW4.Utils.createError(-1,"Invalid EVENT parameter");if(typeof b!="function")return AW4.Utils.createError(-1,"Invalid Listener parameter");if(a==AW4.Connect.EVENT.TRANSFER||a==AW4.Connect.EVENT.ALL)l===0&&(l=setInterval(w,h)),k.push(b);(a==AW4.Connect.EVENT.STATUS||a==AW4.Connect.EVENT.ALL)&&o.push(b);return null},this.authenticate=function(a,b){if(r(a))return AW4.Utils.createError(-1,"Invalid authSpec parameter");t(AW4.Connect.HTTP_METHOD.POST,"/info/authenticate",a,b);return null},this.getAllTransfers=function(a,b){r(b)&&(b=0),u(b,a);return null},this.getStatus=function(){return q},this.initSession=function(a){if(r(f))r(a)?f="^"+r(window.location.hostname)?"localhost":window.location.hostname:f=a;else return AW4.Utils.createError(-1,"Session was already initialized");var b=this.start();if(b==null)return{app_id:f};return b},this.modifyTransfer=function(a,b,c){t(AW4.Connect.HTTP_METHOD.POST,"/transfers/modify/"+a,b,c);return null},this.readAsArrayBuffer=function(a,b){var c={};if(!a)return AW4.Utils.createError(-1,"Invalid options parameter");t(AW4.Connect.HTTP_METHOD.POST,"/file/read-as-array-buffer/",a,b);return null},this.readChunkAsArrayBuffer=function(a,b){if(!a.path||!a.offset||!a.chunkSize)return AW4.Utils.createError(-1,"Invalid parameters");t(AW4.Connect.HTTP_METHOD.POST,"/file/read-chunk-as-array-buffer/",a,b);return null},this.removeEventListener=function(a,b){var c=!1;if(typeof a=="undefined")k.length>0&&(k=[],c=!0),o.length>0&&(o=[],c=!0);else if(typeof a!=typeof AW4.Connect.EVENT.ALL)c=c||x(a,k),c=c||x(a,o);else if(typeof b!="function")(a===AW4.Connect.EVENT.TRANSFER||a===AW4.Connect.EVENT.ALL)&&k.length>0&&(k=[],c=!0),(a===AW4.Connect.EVENT.STATUS||a===AW4.Connect.EVENT.ALL)&&o.length>0&&(o=[],c=!0);else{if(a===AW4.Connect.EVENT.TRANSFER||a===AW4.Connect.EVENT.ALL)c=c||x(b,k);if(a===AW4.Connect.EVENT.STATUS||a===AW4.Connect.EVENT.ALL)c=c||x(b,o)}k.length===0&&(clearInterval(l),l=0);return c},this.removeTransfer=function(a,b){t(AW4.Connect.HTTP_METHOD.POST,"/transfers/remove/"+a,null,b);return null},this.resumeTransfer=function(a,b,c){t(AW4.Connect.HTTP_METHOD.POST,"/transfers/resume/"+a,b,c);return null},this.setDragDropTargets=function(a,b,c){if(!j)return AW4.Utils.createError(-1,"Drop is not enabled in the initialization options, please instantiate Connect again with the dragDropEnabled option set to true.");if(typeof c!="function")return AW4.Utils.createError(-1,"You must provide a valid listener");if(r(b))return AW4.Utils.createError(-1,"You must provide a valid options object");var d=document.querySelectorAll(a);if(d.length==0)return AW4.Utils.createError(-1,"No valid elements for the selector given");var e=function(a){a.stopPropagation(),a.preventDefault(),c({event:a})},f=function(a){a.stopPropagation(),a.preventDefault(),b.dragOver==!0&&c({event:a})},g=function(a){a.stopPropagation(),a.preventDefault();var b=a.dataTransfer.files,d={};d.dataTransfer={},d.dataTransfer.files=[];for(var e=0;e<b.length;e++){var f={lastModifiedDate:b[e].lastModifiedDate,name:b[e].name,size:b[e].size,type:b[e].type};d.dataTransfer.files.push(f)}var g=function(b){c({event:a,files:b})};t(AW4.Connect.HTTP_METHOD.POST,"/file/dropped-files",d,{success:g})};for(var h=0;h<d.length;h++)b.dragEnter==!0&&d[h].addEventListener("dragenter",e),b.dragLeave==!0&&d[h].addEventListener("dragleave",e),(b.dragOver==!0||b.drop!==!1)&&d[h].addEventListener("dragover",f),b.drop!==!1&&d[h].addEventListener("drop",g);return null},this.showAbout=function(a){t(AW4.Connect.HTTP_METHOD.GET,"/windows/about",null,a);return null},this.showDirectory=function(a,b){t(AW4.Connect.HTTP_METHOD.GET,"/windows/finder/"+a,null,b);return null},this.showPreferences=function(a){t(AW4.Connect.HTTP_METHOD.GET,"/windows/preferences",null,a);return null},this.showSaveFileDialog=function(a,b){var c={};r(b)&&(b={}),c.title=b.title||"",c.suggestedName=b.suggestedName||"",c.allowedFileTypes=b.allowedFileTypes||"",t(AW4.Connect.HTTP_METHOD.POST,"/windows/select-save-file-dialog/",c,a);return null},this.showSelectFileDialog=function(a,b){var c={};r(b)&&(b={}),c.title=b.title||"",c.suggestedName=b.suggestedName||"",c.allowMultipleSelection=r(b.allowMultipleSelection)||b.allowMultipleSelection,c.allowedFileTypes=b.allowedFileTypes||"",t(AW4.Connect.HTTP_METHOD.POST,"/windows/select-open-file-dialog/",c,a);return null},this.showSelectFolderDialog=function(a,b){var c={};r(b)&&(b={}),c.title=b.title||"",c.allowMultipleSelection=r(b.allowMultipleSelection)||b.allowMultipleSelection,t(AW4.Connect.HTTP_METHOD.POST,"/windows/select-open-folder-dialog/",c,a);return null},this.showTransferManager=function(a){t(AW4.Connect.HTTP_METHOD.GET,"/windows/transfer-manager",null,a);return null},this.showTransferMonitor=function(a,b){t(AW4.Connect.HTTP_METHOD.GET,"/windows/transfer-monitor/"+a,null,b);return null},this.start=function(){if(f=="")return AW4.Utils.createError(-1,"Please call initSession first");n=new AW4.RequestHandler,n.addStatusListener(z);var a={pluginId:c,containerId:d,initializeTimeout:b,sdkLocation:e};return n.init(a)},this.startTransfer=function(a,b,c){if(r(a))return AW4.Utils.createError(-1,"Invalid transferSpec parameter");b=b||{};var d={transfer_specs:[{transfer_spec:a,aspera_connect_settings:b}]};return this.startTransfers(d,c)},this.startTransfers=function(a,b){if(r(a))return AW4.Utils.createError(-1,"Invalid transferSpecs parameter");var c,d,e,f;d=AW4.Utils.generateUuid();for(c=0;c<a.transfer_specs.length;c++)f=a.transfer_specs[c],s(f),f.aspera_connect_settings.request_id=d,r(f.aspera_connect_settings.back_link)&&(f.aspera_connect_settings.back_link=window.location.href);t(AW4.Connect.HTTP_METHOD.POST,"/transfers/start",a,b);return{request_id:d}},this.stop=function(){return n.stopRequests()},this.stopTransfer=function(a,b){t(AW4.Connect.HTTP_METHOD.POST,"/transfers/stop/"+a,null,b);return null},this.version=function(a){if(r(a))return null;t(AW4.Connect.HTTP_METHOD.GET,"/info/version",null,a);return null}};